GAS LISTING /var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s 			page 1


   1               		.file	"keyboard.c"
   2               		.arch atmega2561
   3               	__SREG__ = 0x3f
   4               	__SP_H__ = 0x3e
   5               	__SP_L__ = 0x3d
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.global __do_copy_data
   9               		.global __do_clear_bss
  10               		.text
  11               	.global	KbScan
  12               		.type	KbScan, @function
  13               	KbScan:
  14               	/* prologue: frame size=0 */
  15               	/* prologue end (size=0) */
  16 0000 A398      		cbi 52-0x20,3
  17               	/* #APP */
  18 0002 0000      		nop
  19 0004 0000      		nop
  20               	/* #NOAPP */
  21 0006 4FB1      		in r20,47-0x20
  22 0008 A39A      		sbi 52-0x20,3
  23 000a A498      		cbi 52-0x20,4
  24               	/* #APP */
  25 000c 0000      		nop
  26 000e 0000      		nop
  27               	/* #NOAPP */
  28 0010 6FB1      		in r22,47-0x20
  29 0012 A49A      		sbi 52-0x20,4
  30 0014 5B98      		cbi 43-0x20,3
  31               	/* #APP */
  32 0016 0000      		nop
  33 0018 0000      		nop
  34               	/* #NOAPP */
  35 001a 8FB1      		in r24,47-0x20
  36 001c 5B9A      		sbi 43-0x20,3
  37 001e 5A98      		cbi 43-0x20,2
  38               	/* #APP */
  39 0020 0000      		nop
  40 0022 0000      		nop
  41               	/* #NOAPP */
  42 0024 2FB1      		in r18,47-0x20
  43 0026 5A9A      		sbi 43-0x20,2
  44 0028 4295      		swap r20
  45 002a 4F70      		andi r20,0x0f
  46 002c 5527      		clr r21
  47 002e 607F      		andi r22,lo8(-16)
  48 0030 7727      		clr r23
  49 0032 462B      		or r20,r22
  50 0034 572B      		or r21,r23
  51 0036 807F      		andi r24,lo8(-16)
  52 0038 9927      		clr r25
  53 003a 34E0      		ldi r19,4
  54 003c 880F      	1:	lsl r24
  55 003e 991F      		rol r25
  56 0040 3A95      		dec r19
  57 0042 01F4      		brne 1b
GAS LISTING /var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s 			page 2


  58 0044 482B      		or r20,r24
  59 0046 592B      		or r21,r25
  60 0048 207F      		andi r18,lo8(-16)
  61 004a 3327      		clr r19
  62 004c 322F      		mov r19,r18
  63 004e 2227      		clr r18
  64 0050 422B      		or r20,r18
  65 0052 532B      		or r21,r19
  66 0054 5093 0000 		sts (KeyFound)+1,r21
  67 0058 4093 0000 		sts KeyFound,r20
  68               	/* epilogue: frame size=0 */
  69 005c 0895      		ret
  70               	/* epilogue end (size=1) */
  71               	/* function KbScan size 55 (54) */
  72               		.size	KbScan, .-KbScan
  73               	.global	GetKeys
  74               		.type	GetKeys, @function
  75               	GetKeys:
  76               	/* prologue: frame size=0 */
  77               	/* prologue end (size=0) */
  78 005e 8091 0000 		lds r24,KeyFound
  79 0062 9091 0000 		lds r25,(KeyFound)+1
  80 0066 9070      		andi r25,hi8(255)
  81               	/* epilogue: frame size=0 */
  82 0068 0895      		ret
  83               	/* epilogue end (size=1) */
  84               	/* function GetKeys size 7 (6) */
  85               		.size	GetKeys, .-GetKeys
  86               	.global	KbSetKeyRepeating
  87               		.type	KbSetKeyRepeating, @function
  88               	KbSetKeyRepeating:
  89               	/* prologue: frame size=0 */
  90               	/* prologue end (size=0) */
  91 006a E82F      		mov r30,r24
  92 006c 862F      		mov r24,r22
  93 006e 8150      		subi r24,lo8(-(-1))
  94 0070 8230      		cpi r24,lo8(2)
  95 0072 00F4      		brsh .L9
  96 0074 E031      		cpi r30,lo8(16)
  97 0076 00F4      		brsh .L9
  98 0078 FF27      		clr r31
  99 007a E050      		subi r30,lo8(-(KeyRepeatArray))
 100 007c F040      		sbci r31,hi8(-(KeyRepeatArray))
 101 007e 6083      		st Z,r22
 102               	.L9:
 103 0080 0895      		ret
 104               	/* epilogue: frame size=0 */
 105               	/* epilogue: noreturn */
 106               	/* epilogue end (size=0) */
 107               	/* function KbSetKeyRepeating size 12 (12) */
 108               		.size	KbSetKeyRepeating, .-KbSetKeyRepeating
 109               	.global	KbGetKey
 110               		.type	KbGetKey, @function
 111               	KbGetKey:
 112               	/* prologue: frame size=0 */
 113               	/* prologue end (size=0) */
 114 0082 8091 0000 		lds r24,KeyBuffer
GAS LISTING /var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s 			page 3


 115 0086 9927      		clr r25
 116               	/* epilogue: frame size=0 */
 117 0088 0895      		ret
 118               	/* epilogue end (size=1) */
 119               	/* function KbGetKey size 4 (3) */
 120               		.size	KbGetKey, .-KbGetKey
 121               	.global	KbInjectKey
 122               		.type	KbInjectKey, @function
 123               	KbInjectKey:
 124               	/* prologue: frame size=0 */
 125               	/* prologue end (size=0) */
 126 008a 8093 0000 		sts KeyBuffer,r24
 127 008e E091 0000 		lds r30,hKBEvent
 128 0092 F091 0000 		lds r31,(hKBEvent)+1
 129 0096 3097      		sbiw r30,0
 130 0098 01F4      		brne .L13
 131 009a 8FEF      		ldi r24,lo8(-1)
 132 009c 9FEF      		ldi r25,hi8(-1)
 133 009e 9093 0000 		sts (hKBEvent)+1,r25
 134 00a2 8093 0000 		sts hKBEvent,r24
 135 00a6 0895      		ret
 136               	.L13:
 137 00a8 8FEF      		ldi r24,hi8(-1)
 138 00aa EF3F      		cpi r30,lo8(-1)
 139 00ac F807      		cpc r31,r24
 140 00ae 01F0      		breq .L17
 141 00b0 8481      		ldd r24,Z+4
 142 00b2 9581      		ldd r25,Z+5
 143 00b4 0196      		adiw r24,1
 144 00b6 9583      		std Z+5,r25
 145 00b8 8483      		std Z+4,r24
 146               	.L17:
 147 00ba 0895      		ret
 148               	/* epilogue: frame size=0 */
 149               	/* epilogue: noreturn */
 150               	/* epilogue end (size=0) */
 151               	/* function KbInjectKey size 25 (25) */
 152               		.size	KbInjectKey, .-KbInjectKey
 153               	.global	KbInit
 154               		.type	KbInit, @function
 155               	KbInit:
 156               	/* prologue: frame size=0 */
 157               	/* prologue end (size=0) */
 158 00bc A39A      		sbi 52-0x20,3
 159 00be A49A      		sbi 52-0x20,4
 160 00c0 5B9A      		sbi 43-0x20,3
 161 00c2 5A9A      		sbi 43-0x20,2
 162 00c4 1092 0000 		sts KbState,__zero_reg__
 163 00c8 8FEF      		ldi r24,lo8(-1)
 164 00ca 9FEF      		ldi r25,hi8(-1)
 165 00cc 9093 0000 		sts (KeyFound)+1,r25
 166 00d0 8093 0000 		sts KeyFound,r24
 167               	/* #APP */
 168 00d4 0FB6      		in  __tmp_reg__, __SREG__
 169 00d6 F894      		cli
 170 00d8 0F92      		push __tmp_reg__
 171               		
GAS LISTING /var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s 			page 4


 172               	/* #NOAPP */
 173 00da 1092 0000 		sts (hKBEvent)+1,__zero_reg__
 174 00de 1092 0000 		sts hKBEvent,__zero_reg__
 175               	/* #APP */
 176 00e2 0F90      		pop __tmp_reg__
 177 00e4 0FBE      		out __SREG__, __tmp_reg__
 178               		
 179               	/* #NOAPP */
 180 00e6 8FEF      		ldi r24,lo8(-1)
 181 00e8 8093 0000 		sts KeyBuffer,r24
 182 00ec E0E0      		ldi r30,lo8(KeyRepeatArray)
 183 00ee F0E0      		ldi r31,hi8(KeyRepeatArray)
 184 00f0 82E0      		ldi r24,lo8(2)
 185               	.L19:
 186 00f2 8193      		st Z+,r24
 187 00f4 90E0      		ldi r25,hi8(KeyRepeatArray+16)
 188 00f6 E030      		cpi r30,lo8(KeyRepeatArray+16)
 189 00f8 F907      		cpc r31,r25
 190 00fa 01F4      		brne .L19
 191 00fc 1092 0000 		sts (HoldCounter)+1,__zero_reg__
 192 0100 1092 0000 		sts HoldCounter,__zero_reg__
 193 0104 61E0      		ldi r22,lo8(1)
 194 0106 88E0      		ldi r24,lo8(8)
 195 0108 0E94 0000 		call KbSetKeyRepeating
 196 010c 61E0      		ldi r22,lo8(1)
 197 010e 8BE0      		ldi r24,lo8(11)
 198 0110 0E94 0000 		call KbSetKeyRepeating
 199 0114 61E0      		ldi r22,lo8(1)
 200 0116 8AE0      		ldi r24,lo8(10)
 201 0118 0E94 0000 		call KbSetKeyRepeating
 202 011c 61E0      		ldi r22,lo8(1)
 203 011e 8CE0      		ldi r24,lo8(12)
 204 0120 0E94 0000 		call KbSetKeyRepeating
 205               	/* epilogue: frame size=0 */
 206 0124 0895      		ret
 207               	/* epilogue end (size=1) */
 208               	/* function KbInit size 62 (61) */
 209               		.size	KbInit, .-KbInit
 210               	.global	KbWaitForKeyEvent
 211               		.type	KbWaitForKeyEvent, @function
 212               	KbWaitForKeyEvent:
 213               	/* prologue: frame size=0 */
 214               	/* prologue end (size=0) */
 215 0126 AB01      		movw r20,r22
 216 0128 BC01      		movw r22,r24
 217 012a 80E0      		ldi r24,lo8(hKBEvent)
 218 012c 90E0      		ldi r25,hi8(hKBEvent)
 219 012e 0E94 0000 		call NutEventWait
 220 0132 20E0      		ldi r18,lo8(0)
 221 0134 30E0      		ldi r19,hi8(0)
 222 0136 8F5F      		subi r24,lo8(-1)
 223 0138 9F4F      		sbci r25,hi8(-1)
 224 013a 01F4      		brne .L25
 225 013c 21E0      		ldi r18,lo8(1)
 226 013e 30E0      		ldi r19,hi8(1)
 227               	.L25:
 228 0140 C901      		movw r24,r18
GAS LISTING /var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s 			page 5


 229               	/* epilogue: frame size=0 */
 230 0142 0895      		ret
 231               	/* epilogue end (size=1) */
 232               	/* function KbWaitForKeyEvent size 16 (15) */
 233               		.size	KbWaitForKeyEvent, .-KbWaitForKeyEvent
 234               		.lcomm hKBEvent,2
 235               		.lcomm KeyFound,2
 236               		.lcomm KeyBuffer,1
 237               		.lcomm HoldCounter,2
 238               		.lcomm KbState,1
 239               		.lcomm KeyRepeatArray,16
 240               	/* File "source/keyboard.c": code  181 = 0x00b5 ( 176), prologues   0, epilogues   5 */
GAS LISTING /var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s 			page 6


DEFINED SYMBOLS
                            *ABS*:00000000 keyboard.c
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:3      *ABS*:0000003f __SREG__
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:4      *ABS*:0000003e __SP_H__
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:5      *ABS*:0000003d __SP_L__
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:6      *ABS*:00000000 __tmp_reg__
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:7      *ABS*:00000001 __zero_reg__
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:13     .text:00000000 KbScan
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:234    .bss:00000002 KeyFound
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:75     .text:0000005e GetKeys
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:88     .text:0000006a KbSetKeyRepeating
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:238    .bss:00000008 KeyRepeatArray
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:111    .text:00000082 KbGetKey
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:235    .bss:00000004 KeyBuffer
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:123    .text:0000008a KbInjectKey
                             .bss:00000000 hKBEvent
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:155    .text:000000bc KbInit
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:237    .bss:00000007 KbState
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:236    .bss:00000005 HoldCounter
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//cckaLJvU.s:212    .text:00000126 KbWaitForKeyEvent

UNDEFINED SYMBOLS
__do_copy_data
__do_clear_bss
NutEventWait
