GAS LISTING /var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s 			page 1


   1               		.file	"keyboard.c"
   2               		.arch atmega2561
   3               	__SREG__ = 0x3f
   4               	__SP_H__ = 0x3e
   5               	__SP_L__ = 0x3d
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.global __do_copy_data
   9               		.global __do_clear_bss
  10               		.text
  11               	.global	KbScan
  12               		.type	KbScan, @function
  13               	KbScan:
  14               	/* prologue: frame size=0 */
  15               	/* prologue end (size=0) */
  16 0000 A398      		cbi 52-0x20,3
  17               	/* #APP */
  18 0002 0000      		nop
  19 0004 0000      		nop
  20               	/* #NOAPP */
  21 0006 4FB1      		in r20,47-0x20
  22 0008 A39A      		sbi 52-0x20,3
  23 000a A498      		cbi 52-0x20,4
  24               	/* #APP */
  25 000c 0000      		nop
  26 000e 0000      		nop
  27               	/* #NOAPP */
  28 0010 6FB1      		in r22,47-0x20
  29 0012 A49A      		sbi 52-0x20,4
  30 0014 5B98      		cbi 43-0x20,3
  31               	/* #APP */
  32 0016 0000      		nop
  33 0018 0000      		nop
  34               	/* #NOAPP */
  35 001a 8FB1      		in r24,47-0x20
  36 001c 5B9A      		sbi 43-0x20,3
  37 001e 5A98      		cbi 43-0x20,2
  38               	/* #APP */
  39 0020 0000      		nop
  40 0022 0000      		nop
  41               	/* #NOAPP */
  42 0024 2FB1      		in r18,47-0x20
  43 0026 5A9A      		sbi 43-0x20,2
  44 0028 4295      		swap r20
  45 002a 4F70      		andi r20,0x0f
  46 002c 5527      		clr r21
  47 002e 607F      		andi r22,lo8(-16)
  48 0030 7727      		clr r23
  49 0032 462B      		or r20,r22
  50 0034 572B      		or r21,r23
  51 0036 807F      		andi r24,lo8(-16)
  52 0038 9927      		clr r25
  53 003a 34E0      		ldi r19,4
  54 003c 880F      	1:	lsl r24
  55 003e 991F      		rol r25
  56 0040 3A95      		dec r19
  57 0042 01F4      		brne 1b
GAS LISTING /var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s 			page 2


  58 0044 482B      		or r20,r24
  59 0046 592B      		or r21,r25
  60 0048 207F      		andi r18,lo8(-16)
  61 004a 3327      		clr r19
  62 004c 322F      		mov r19,r18
  63 004e 2227      		clr r18
  64 0050 422B      		or r20,r18
  65 0052 532B      		or r21,r19
  66 0054 5093 0000 		sts (KeyFound)+1,r21
  67 0058 4093 0000 		sts KeyFound,r20
  68 005c 4093 0000 		sts KeyBuffer,r20
  69               	/* epilogue: frame size=0 */
  70 0060 0895      		ret
  71               	/* epilogue end (size=1) */
  72               	/* function KbScan size 57 (56) */
  73               		.size	KbScan, .-KbScan
  74               	.global	isKeyPressed
  75               		.type	isKeyPressed, @function
  76               	isKeyPressed:
  77               	/* prologue: frame size=0 */
  78               	/* prologue end (size=0) */
  79 0062 40E0      		ldi r20,lo8(0)
  80 0064 50E0      		ldi r21,hi8(0)
  81 0066 2091 0000 		lds r18,KeyFound
  82 006a 3091 0000 		lds r19,(KeyFound)+1
  83 006e 2823      		and r18,r24
  84 0070 3923      		and r19,r25
  85 0072 232B      		or r18,r19
  86 0074 01F4      		brne .L4
  87 0076 41E0      		ldi r20,lo8(1)
  88 0078 50E0      		ldi r21,hi8(1)
  89               	.L4:
  90 007a CA01      		movw r24,r20
  91               	/* epilogue: frame size=0 */
  92 007c 0895      		ret
  93               	/* epilogue end (size=1) */
  94               	/* function isKeyPressed size 14 (13) */
  95               		.size	isKeyPressed, .-isKeyPressed
  96               	.global	KbSetKeyRepeating
  97               		.type	KbSetKeyRepeating, @function
  98               	KbSetKeyRepeating:
  99               	/* prologue: frame size=0 */
 100               	/* prologue end (size=0) */
 101 007e E82F      		mov r30,r24
 102 0080 862F      		mov r24,r22
 103 0082 8150      		subi r24,lo8(-(-1))
 104 0084 8230      		cpi r24,lo8(2)
 105 0086 00F4      		brsh .L10
 106 0088 E031      		cpi r30,lo8(16)
 107 008a 00F4      		brsh .L10
 108 008c FF27      		clr r31
 109 008e E050      		subi r30,lo8(-(KeyRepeatArray))
 110 0090 F040      		sbci r31,hi8(-(KeyRepeatArray))
 111 0092 6083      		st Z,r22
 112               	.L10:
 113 0094 0895      		ret
 114               	/* epilogue: frame size=0 */
GAS LISTING /var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s 			page 3


 115               	/* epilogue: noreturn */
 116               	/* epilogue end (size=0) */
 117               	/* function KbSetKeyRepeating size 12 (12) */
 118               		.size	KbSetKeyRepeating, .-KbSetKeyRepeating
 119               	.global	KbGetKey
 120               		.type	KbGetKey, @function
 121               	KbGetKey:
 122               	/* prologue: frame size=0 */
 123               	/* prologue end (size=0) */
 124 0096 8091 0000 		lds r24,KeyBuffer
 125 009a 9927      		clr r25
 126               	/* epilogue: frame size=0 */
 127 009c 0895      		ret
 128               	/* epilogue end (size=1) */
 129               	/* function KbGetKey size 4 (3) */
 130               		.size	KbGetKey, .-KbGetKey
 131               	.global	KbInjectKey
 132               		.type	KbInjectKey, @function
 133               	KbInjectKey:
 134               	/* prologue: frame size=0 */
 135               	/* prologue end (size=0) */
 136 009e 8093 0000 		sts KeyBuffer,r24
 137 00a2 E091 0000 		lds r30,hKBEvent
 138 00a6 F091 0000 		lds r31,(hKBEvent)+1
 139 00aa 3097      		sbiw r30,0
 140 00ac 01F4      		brne .L14
 141 00ae 8FEF      		ldi r24,lo8(-1)
 142 00b0 9FEF      		ldi r25,hi8(-1)
 143 00b2 9093 0000 		sts (hKBEvent)+1,r25
 144 00b6 8093 0000 		sts hKBEvent,r24
 145 00ba 0895      		ret
 146               	.L14:
 147 00bc 8FEF      		ldi r24,hi8(-1)
 148 00be EF3F      		cpi r30,lo8(-1)
 149 00c0 F807      		cpc r31,r24
 150 00c2 01F0      		breq .L18
 151 00c4 8481      		ldd r24,Z+4
 152 00c6 9581      		ldd r25,Z+5
 153 00c8 0196      		adiw r24,1
 154 00ca 9583      		std Z+5,r25
 155 00cc 8483      		std Z+4,r24
 156               	.L18:
 157 00ce 0895      		ret
 158               	/* epilogue: frame size=0 */
 159               	/* epilogue: noreturn */
 160               	/* epilogue end (size=0) */
 161               	/* function KbInjectKey size 25 (25) */
 162               		.size	KbInjectKey, .-KbInjectKey
 163               	.global	KbInit
 164               		.type	KbInit, @function
 165               	KbInit:
 166               	/* prologue: frame size=0 */
 167               	/* prologue end (size=0) */
 168 00d0 A39A      		sbi 52-0x20,3
 169 00d2 A49A      		sbi 52-0x20,4
 170 00d4 5B9A      		sbi 43-0x20,3
 171 00d6 5A9A      		sbi 43-0x20,2
GAS LISTING /var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s 			page 4


 172 00d8 1092 0000 		sts KbState,__zero_reg__
 173 00dc 8FEF      		ldi r24,lo8(-1)
 174 00de 9FEF      		ldi r25,hi8(-1)
 175 00e0 9093 0000 		sts (KeyFound)+1,r25
 176 00e4 8093 0000 		sts KeyFound,r24
 177               	/* #APP */
 178 00e8 0FB6      		in  __tmp_reg__, __SREG__
 179 00ea F894      		cli
 180 00ec 0F92      		push __tmp_reg__
 181               		
 182               	/* #NOAPP */
 183 00ee 1092 0000 		sts (hKBEvent)+1,__zero_reg__
 184 00f2 1092 0000 		sts hKBEvent,__zero_reg__
 185               	/* #APP */
 186 00f6 0F90      		pop __tmp_reg__
 187 00f8 0FBE      		out __SREG__, __tmp_reg__
 188               		
 189               	/* #NOAPP */
 190 00fa 8FEF      		ldi r24,lo8(-1)
 191 00fc 8093 0000 		sts KeyBuffer,r24
 192 0100 E0E0      		ldi r30,lo8(KeyRepeatArray)
 193 0102 F0E0      		ldi r31,hi8(KeyRepeatArray)
 194 0104 82E0      		ldi r24,lo8(2)
 195               	.L20:
 196 0106 8193      		st Z+,r24
 197 0108 90E0      		ldi r25,hi8(KeyRepeatArray+16)
 198 010a E030      		cpi r30,lo8(KeyRepeatArray+16)
 199 010c F907      		cpc r31,r25
 200 010e 01F4      		brne .L20
 201 0110 1092 0000 		sts (HoldCounter)+1,__zero_reg__
 202 0114 1092 0000 		sts HoldCounter,__zero_reg__
 203 0118 61E0      		ldi r22,lo8(1)
 204 011a 88E0      		ldi r24,lo8(8)
 205 011c 0E94 0000 		call KbSetKeyRepeating
 206 0120 61E0      		ldi r22,lo8(1)
 207 0122 8BE0      		ldi r24,lo8(11)
 208 0124 0E94 0000 		call KbSetKeyRepeating
 209 0128 61E0      		ldi r22,lo8(1)
 210 012a 8AE0      		ldi r24,lo8(10)
 211 012c 0E94 0000 		call KbSetKeyRepeating
 212 0130 61E0      		ldi r22,lo8(1)
 213 0132 8CE0      		ldi r24,lo8(12)
 214 0134 0E94 0000 		call KbSetKeyRepeating
 215               	/* epilogue: frame size=0 */
 216 0138 0895      		ret
 217               	/* epilogue end (size=1) */
 218               	/* function KbInit size 62 (61) */
 219               		.size	KbInit, .-KbInit
 220               	.global	KbWaitForKeyEvent
 221               		.type	KbWaitForKeyEvent, @function
 222               	KbWaitForKeyEvent:
 223               	/* prologue: frame size=0 */
 224               	/* prologue end (size=0) */
 225 013a AB01      		movw r20,r22
 226 013c BC01      		movw r22,r24
 227 013e 80E0      		ldi r24,lo8(hKBEvent)
 228 0140 90E0      		ldi r25,hi8(hKBEvent)
GAS LISTING /var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s 			page 5


 229 0142 0E94 0000 		call NutEventWait
 230 0146 20E0      		ldi r18,lo8(0)
 231 0148 30E0      		ldi r19,hi8(0)
 232 014a 8F5F      		subi r24,lo8(-1)
 233 014c 9F4F      		sbci r25,hi8(-1)
 234 014e 01F4      		brne .L26
 235 0150 21E0      		ldi r18,lo8(1)
 236 0152 30E0      		ldi r19,hi8(1)
 237               	.L26:
 238 0154 C901      		movw r24,r18
 239               	/* epilogue: frame size=0 */
 240 0156 0895      		ret
 241               	/* epilogue end (size=1) */
 242               	/* function KbWaitForKeyEvent size 16 (15) */
 243               		.size	KbWaitForKeyEvent, .-KbWaitForKeyEvent
 244               		.lcomm hKBEvent,2
 245               		.lcomm KeyFound,2
 246               		.lcomm KeyBuffer,1
 247               		.lcomm HoldCounter,2
 248               		.lcomm KbState,1
 249               		.lcomm KeyRepeatArray,16
 250               	/* File "source/keyboard.c": code  190 = 0x00be ( 185), prologues   0, epilogues   5 */
GAS LISTING /var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s 			page 6


DEFINED SYMBOLS
                            *ABS*:00000000 keyboard.c
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:3      *ABS*:0000003f __SREG__
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:4      *ABS*:0000003e __SP_H__
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:5      *ABS*:0000003d __SP_L__
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:6      *ABS*:00000000 __tmp_reg__
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:7      *ABS*:00000001 __zero_reg__
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:13     .text:00000000 KbScan
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:244    .bss:00000002 KeyFound
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:245    .bss:00000004 KeyBuffer
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:76     .text:00000062 isKeyPressed
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:98     .text:0000007e KbSetKeyRepeating
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:248    .bss:00000008 KeyRepeatArray
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:121    .text:00000096 KbGetKey
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:133    .text:0000009e KbInjectKey
                             .bss:00000000 hKBEvent
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:165    .text:000000d0 KbInit
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:247    .bss:00000007 KbState
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:246    .bss:00000005 HoldCounter
/var/folders/_4/0gv1xzls4452yr8f8wz3qh880000gn/T//ccYlo2Ug.s:222    .text:0000013a KbWaitForKeyEvent

UNDEFINED SYMBOLS
__do_copy_data
__do_clear_bss
NutEventWait
